{"version":3,"file":"functions.js","mappings":";yBACA,IAAIA,EAAsB,CAAC,qPCA3B,ovNAwKC,kCA5BM,0FAUM,OAHPC,EAAM,IAAIC,gBACVC,KAAK,MAAO,sCAAsC,GACtDF,EAAIG,iBAAiB,8BAA+B,KACpDH,EAAII,OAAO,UACYC,MAAM,iEAA+D,CAC1FC,OAAQ,OACRC,QAAS,CACP,eAAgB,mBAChBC,cAAe,8DAEjBC,KAAMC,KAAKC,UAAU,CACnBC,OAjBW,gBAkBXC,WAhBc,GAiBdC,YAhBgB,OAkBlB,QAXY,OAARC,EAAW,EAAH,eAaKA,EAASC,OAAM,QAEb,OAFfC,EAAO,EAAH,KACJC,EAAUD,EAAKE,QAAQ,GAAGC,KAChCC,QAAQC,IAAIJ,GAAS,kBACdA,GAAO,6CACf,sBCxKDnB,EAAoBwB,EAAI,SAASC,EAASC,GACzC,IAAI,IAAIC,KAAOD,EACX1B,EAAoB4B,EAAEF,EAAYC,KAAS3B,EAAoB4B,EAAEH,EAASE,IAC5EE,OAAOC,eAAeL,EAASE,EAAK,CAAEI,YAAY,EAAMC,IAAKN,EAAWC,IAG3E,ECPA3B,EAAoB4B,EAAI,SAASK,EAAKC,GAAQ,OAAOL,OAAOM,UAAUC,eAAeC,KAAKJ,EAAKC,EAAO,EF4KtGI,gBAAgBC,UAAU,OAnKnB,SAAaC,EAAOC,GACzB,OAAOD,EAAQC,CACjB,IAkKAH,gBAAgBC,UAAU,SA3JnB,SAAeG,GACpB,IAAMC,EAAQC,aAAY,WACxB,IAAMC,GAcD,IAAIC,MAAOC,qBAbhBL,EAAWM,UAAUH,EACvB,GAAG,KAEHH,EAAWO,WAAa,WACtBC,cAAcP,EAChB,CACF,IAmJAL,gBAAgBC,UAAU,aAnInB,SAAmBY,EAAaT,GACrC,IAAIU,EAAS,EACPT,EAAQC,aAAY,WACxBQ,GAAUD,EACVT,EAAWM,UAAUI,EACvB,GAAG,KAEHV,EAAWO,WAAa,WACtBC,cAAcP,EAChB,CACF,IA0HAL,gBAAgBC,UAAU,OAlHnB,SAAoBpB,GAGzB,OAFAG,QAAQC,IAAIJ,GAELA,CACT,IA+GAmB,gBAAgBC,UAAU,eAlGnB,SAAqBc,GAK1B,IAJA,IAEIC,EAFEC,EAAU,IAAIC,UAAUH,GAC5BI,EAAIC,KAAKC,KAAKN,GAEdO,EAAMP,EAAS,EAAI,CAAC,CAAC,IAAM,GACpBQ,EAAI,EAAGA,EAAIR,EAAQQ,GAAK,EAC/B,IAAKN,EAAQM,KACXD,EAAIE,KAAK,CAACD,IACNA,GAAKJ,GACP,IAAK,IAAIM,EAAIF,GAAIP,EAAIO,EAAIE,GAAKV,EAAQU,GAAK,EAAGR,EAAQD,GAAK,EAIjE,OAAOM,CACT,IAqFAtB,gBAAgBC,UAAU,OApCnB,WAAkB","sources":["webpack://excel-custom-functions-js/webpack/bootstrap","webpack://excel-custom-functions-js/./src/functions/functions.js","webpack://excel-custom-functions-js/webpack/runtime/define property getters","webpack://excel-custom-functions-js/webpack/runtime/hasOwnProperty shorthand"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","/* global clearInterval, console, setInterval */\n\n/**\n * Add two numbers\n * @customfunction\n * @param {number} first First number\n * @param {number} second Second number\n * @returns {number} The sum of the two numbers.\n */\nexport function add(first, second) {\n  return first + second;\n}\n\n/**\n * Displays the current time once a second\n * @customfunction\n * @param {CustomFunctions.StreamingInvocation<string>} invocation Custom function invocation\n */\nexport function clock(invocation) {\n  const timer = setInterval(() => {\n    const time = currentTime();\n    invocation.setResult(time);\n  }, 1000);\n\n  invocation.onCanceled = () => {\n    clearInterval(timer);\n  };\n}\n\n/**\n * Returns the current time\n * @returns {string} String with the current time formatted for the current locale.\n */\nexport function currentTime() {\n  return new Date().toLocaleTimeString();\n}\n\n/**\n * Increments a value once a second.\n * @customfunction\n * @param {number} incrementBy Amount to increment\n * @param {CustomFunctions.StreamingInvocation<number>} invocation\n */\nexport function increment(incrementBy, invocation) {\n  let result = 0;\n  const timer = setInterval(() => {\n    result += incrementBy;\n    invocation.setResult(result);\n  }, 1000);\n\n  invocation.onCanceled = () => {\n    clearInterval(timer);\n  };\n}\n\n/**\n * Writes a message to console.log().\n * @customfunction LOG\n * @param {string} message String to write.\n * @returns String to write.\n */\nexport function logMessage(message) {\n  console.log(message);\n\n  return message;\n}\n\n/*\n生成质数。\n\n */\n\n/**\n *\n * @customfunction\n * @param {number} target\n * @returns {number[][]} The sum of the two numbers.\n */\nexport function PrintPrimes(target) {\n  const isPrime = new Int8Array(target),\n    m = Math.sqrt(target);\n  let k,\n    res = target > 2 ? [[2]] : [];\n  for (let i = 3; i < target; i += 2) {\n    if (!isPrime[i]) {\n      res.push([i]);\n      if (i <= m) {\n        for (let j = i; (k = i * j) < target; j += 2) isPrime[k] = 1;\n      }\n    }\n  }\n  return res;\n}\n\n/*\n 连接ChatGPT。\n\n */\n\nexport function generateText(promptText) {\n  const url = \"https://api.openai.com/v1/engines/davinci-codex/completions\";\n  const prompt = promptText;\n  const maxTokens = 1024;\n  const temperature = 0.7;\n  const topP = 1;\n  const n = 1;\n\n  const body = JSON.stringify({\n    prompt: prompt,\n    max_tokens: maxTokens,\n    temperature: temperature,\n    top_p: topP,\n    n: n,\n    stream: false,\n  });\n\n  const headers = {\n    \"Content-Type\": \"application/json\",\n    Authorization: \"Bearer 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\",\n  };\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: headers,\n    body: body,\n  })\n    .then((response) => response.json())\n    .then((data) => {\n      return data.choices[0].text;\n    })\n    .catch((error) => {\n      console.error(\"Error:\", error);\n    });\n}\n\n\n\n/**\n * @customfunction\n \n */\nexport async function run() {\n  const prompt = \"你好，我是ChatGPT。\";\n  const model = \"text-davinci-002\";\n  const maxTokens = 50;\n  const temperature = 0.5;\n  const apiKey = \"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\";\n  // 发送请求给ChatGPT\n  var xhr = new XMLHttpRequest();\n  xhr.open(\"GET\", \"https://api.openai.com/v1/engines/\", true);\n  xhr.setRequestHeader(\"Access-Control-Allow-Origin\", \"*\");\n  xhr.send();\n  const response = await fetch(\"https://api.openai.com/v1/engines/\" + model + \"/completions\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Authorization: \"Bearer \" + apiKey\n    },\n    body: JSON.stringify({\n      prompt: prompt,\n      max_tokens: maxTokens,\n      temperature: temperature\n    })\n  });\n  // 解析响应\n  const data = await response.json();\n  const message = data.choices[0].text;\n  console.log(message);\n  return message;\n}\n\n\nCustomFunctions.associate(\"ADD\", add);\nCustomFunctions.associate(\"CLOCK\", clock);\nCustomFunctions.associate(\"INCREMENT\", increment);\nCustomFunctions.associate(\"LOG\", logMessage);\nCustomFunctions.associate(\"PRINTPRIMES\", PrintPrimes);\nCustomFunctions.associate(\"RUN\", run);","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }"],"names":["__webpack_require__","xhr","XMLHttpRequest","open","setRequestHeader","send","fetch","method","headers","Authorization","body","JSON","stringify","prompt","max_tokens","temperature","response","json","data","message","choices","text","console","log","d","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","CustomFunctions","associate","first","second","invocation","timer","setInterval","time","Date","toLocaleTimeString","setResult","onCanceled","clearInterval","incrementBy","result","target","k","isPrime","Int8Array","m","Math","sqrt","res","i","push","j"],"sourceRoot":""}